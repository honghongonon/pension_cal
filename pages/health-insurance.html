<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M92225DERV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-M92225DERV');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="í‡´ì§ í›„ ì§€ì—­ê°€ì…ì ê±´ê°•ë³´í—˜ë£Œ ê³„ì‚°, í”¼ë¶€ì–‘ì ìê²© íŒì •, ì„ì˜ê³„ì†ê°€ì… ë¹„êµ. 2025ë…„ ê¸°ì¤€.">
  <title>ê±´ê°•ë³´í—˜ë£Œ ê³„ì‚°ê¸° - ì—°ê¸ˆ í¬í„¸</title>
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css">
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/calculator.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
  <!-- Google AdSense -->
  <meta name="google-adsense-account" content="ca-pub-7327747719856671">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7327747719856671" crossorigin="anonymous"></script>
</head>
<body>
  <nav id="main-nav"></nav>

  <div class="container">
    <div class="page-header fade-in">
      <h1 class="page-title">ê±´ê°•ë³´í—˜ë£Œ ê³„ì‚°ê¸°</h1>
      <p class="page-subtitle">í‡´ì§ í›„ ì§€ì—­ê°€ì…ì ë³´í—˜ë£Œ, í”¼ë¶€ì–‘ì íŒì •, ì„ì˜ê³„ì†ê°€ì… ë¹„êµ</p>
    </div>

    <div class="info-box info fade-in">
      <span class="icon">ğŸ’¡</span>
      <div>
        <strong>í‡´ì§ í›„ ê±´ê°•ë³´í—˜ 3ê°€ì§€ ì„ íƒì§€</strong><br>
        â‘  ê°€ì¡±ì˜ <strong>í”¼ë¶€ì–‘ì</strong> ë“±ë¡ (ë³´í—˜ë£Œ 0ì›, ì†Œë“Â·ì¬ì‚° ìš”ê±´ ì¶©ì¡± ì‹œ)<br>
        â‘¡ <strong>ì„ì˜ê³„ì†ê°€ì…</strong> (í‡´ì§ ì „ ë³´í—˜ë£Œ ìœ ì§€, ìµœëŒ€ 3ë…„)<br>
        â‘¢ <strong>ì§€ì—­ê°€ì…ì</strong> ì „í™˜ (ì†Œë“+ì¬ì‚°+ìë™ì°¨ ê¸°ì¤€ ë¶€ê³¼)
      </div>
    </div>

    <!-- íƒ­ -->
    <div class="tabs fade-in">
      <button class="tab-btn active" onclick="HealthIns.switchTab('regional', this)">ì§€ì—­ê°€ì…ì ë³´í—˜ë£Œ</button>
      <button class="tab-btn" onclick="HealthIns.switchTab('dependent', this)">í”¼ë¶€ì–‘ì íŒì •</button>
      <button class="tab-btn" onclick="HealthIns.switchTab('compare', this)">ì„ì˜ê³„ì† vs ì§€ì—­</button>
    </div>

    <!-- ==============================
         íƒ­1: ì§€ì—­ê°€ì…ì ë³´í—˜ë£Œ
         ============================== -->
    <div class="tab-content active" id="tab-regional">
      <div class="calc-layout">
        <div class="calc-input-panel">
          <div class="card">
            <h2 class="card-title"><span class="card-icon">ğŸ“</span>ì†Œë“Â·ì¬ì‚° ì •ë³´</h2>
            <form id="hiRegionalForm">
              <div class="input-section">
                <div class="input-section-title">ì†Œë“ (ì—°ê°„)</div>
                <div class="form-group">
                  <label class="form-label">ì—°ê¸ˆì†Œë“ <span class="unit">(ë§Œì›/ë…„)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="pensionIncome" data-type="money" value="1,200">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">ì´ìÂ·ë°°ë‹¹Â·ì‚¬ì—…Â·ê¸°íƒ€ì†Œë“ <span class="unit">(ë§Œì›/ë…„)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="otherIncome" data-type="money" value="0">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
              </div>
              <div class="input-section">
                <div class="input-section-title">ì¬ì‚°</div>
                <div class="form-group">
                  <label class="form-label">ì¬ì‚°ì„¸ ê³¼í‘œ <span class="unit">(ë§Œì›)</span>
                    <span class="tooltip-trigger" data-tooltip="ì¬ì‚°ì„¸ ê³¼ì„¸í‘œì¤€ = ê³µì‹œê°€ê²©ì˜ ì•½ 60%. ì•„íŒŒíŠ¸ ê³µì‹œê°€ 5ì–µì´ë©´ ê³¼í‘œ ì•½ 3ì–µ. ê¸°ë³¸ê³µì œ 1ì–µì› ì ìš© í›„ ë“±ê¸‰ë³„ ì ìˆ˜ ì‚°ì •.">?</span>
                  </label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="propertyValue" data-type="money" value="30,000">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
              </div>
              <div class="input-section">
                <div class="input-section-title">ìë™ì°¨ (2024.02 íì§€)</div>
                <p class="form-help highlight">2024ë…„ 2ì›”ë¶€í„° ìë™ì°¨ì— ëŒ€í•œ ë³´í—˜ë£Œ ë¶€ê³¼ëŠ” ì „ë©´ íì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                <div class="form-group">
                  <label class="form-label">ìë™ì°¨ ê°€ì•¡ <span class="unit">(ë§Œì›)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="carValue" data-type="money" value="0" disabled>
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
                <div class="form-group hidden">
                  <label class="form-label">ë°°ê¸°ëŸ‰ <span class="unit">(cc)</span></label>
                  <div class="input-group">
                    <input type="number" class="form-input" name="carCC" value="0" min="0" max="10000">
                    <span class="input-suffix">cc</span>
                  </div>
                </div>
              </div>
              <button type="button" class="btn btn-primary btn-block btn-lg" onclick="HealthIns.calcRegional()">ê³„ì‚°í•˜ê¸°</button>
            </form>
          </div>
        </div>

        <div class="calc-result-panel">
          <div id="rg-empty" class="card">
            <div class="empty-result">
              <div class="icon">ğŸ¥</div>
              <div class="text">ì†Œë“Â·ì¬ì‚° ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ê³„ì‚°í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
            </div>
          </div>

          <div id="rg-result" class="hidden">
            <div class="result-banner fade-in">
              <div class="label">ì›” ê±´ê°•ë³´í—˜ë£Œ (ì¥ê¸°ìš”ì–‘ í¬í•¨)</div>
              <div class="amount" id="rg-total">-</div>
              <div class="sub">ê±´ê°•ë³´í—˜ë£Œ + ì¥ê¸°ìš”ì–‘ë³´í—˜ë£Œ</div>
            </div>

            <div class="result-mini-grid fade-in">
              <div class="result-mini">
                <div class="label">ê±´ê°•ë³´í—˜ë£Œ</div>
                <div class="value" id="rg-health">-</div>
              </div>
              <div class="result-mini">
                <div class="label">ì¥ê¸°ìš”ì–‘ë³´í—˜ë£Œ</div>
                <div class="value" id="rg-ltc">-</div>
              </div>
              <div class="result-mini">
                <div class="label">ì—°ê°„ í•©ê³„</div>
                <div class="value red" id="rg-annual">-</div>
              </div>
            </div>

            <div class="card fade-in">
              <h2 class="card-title"><span class="card-icon">ğŸ“Š</span>ë³´í—˜ë£Œ êµ¬ì„±</h2>
              <div class="chart-container">
                <canvas id="rgChart"></canvas>
              </div>
            </div>

            <div class="card fade-in">
              <h2 class="card-title"><span class="card-icon">ğŸ”</span>ì‚°ì¶œ ë‚´ì—­</h2>
              <div class="result-details" id="rg-details"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==============================
         íƒ­2: í”¼ë¶€ì–‘ì íŒì •
         ============================== -->
    <div class="tab-content" id="tab-dependent">
      <div class="calc-layout">
        <div class="calc-input-panel">
          <div class="card">
            <h2 class="card-title"><span class="card-icon">ğŸ“</span>í”¼ë¶€ì–‘ì ìš”ê±´ í™•ì¸</h2>
            <form id="hiDependentForm">
              <div class="form-group">
                <label class="form-label">ì—°ê°„ ì†Œë“ í•©ê³„ <span class="unit">(ë§Œì›)</span>
                  <span class="tooltip-trigger" data-tooltip="ì´ìÂ·ë°°ë‹¹Â·ì‚¬ì—…Â·ê·¼ë¡œÂ·ì—°ê¸ˆÂ·ê¸°íƒ€ì†Œë“ í•©ê³„. êµ­ë¯¼ì—°ê¸ˆ ë“± ê³µì ì—°ê¸ˆ í¬í•¨.">?</span>
                </label>
                <div class="input-group">
                  <input type="text" class="form-input" name="annualIncome" data-type="money" value="1,500">
                  <span class="input-suffix">ë§Œì›</span>
                </div>
              </div>
              <div class="form-group">
                <label class="form-label">ì¬ì‚°ì„¸ ê³¼í‘œ <span class="unit">(ë§Œì›)</span></label>
                <div class="input-group">
                  <input type="text" class="form-input" name="propertyTax" data-type="money" value="30,000">
                  <span class="input-suffix">ë§Œì›</span>
                </div>
              </div>
              <button type="button" class="btn btn-primary btn-block btn-lg" onclick="HealthIns.calcDependent()">íŒì •í•˜ê¸°</button>
            </form>

            <div class="info-box info mt-lg">
              <span class="icon">ğŸ“Œ</span>
              <div>
                <strong>í”¼ë¶€ì–‘ì ìê²© ìš”ê±´ (2025~2026)</strong><br>
                â€¢ ì†Œë“: ì—° 2,000ë§Œì› ì´í•˜<br>
                â€¢ ì¬ì‚°: ê³¼ì„¸í‘œì¤€ 5.4ì–µ ì´í•˜<br>
                â€¢ ì¬ì‚° 9ì–µ ì´ˆê³¼ ì‹œ: ì†Œë“ 1,000ë§Œì› ì´í•˜
              </div>
            </div>
          </div>
        </div>

        <div class="calc-result-panel">
          <div id="dp-empty" class="card">
            <div class="empty-result">
              <div class="icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦</div>
              <div class="text">ì†Œë“Â·ì¬ì‚° ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  íŒì •í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
            </div>
          </div>

          <div id="dp-result" class="hidden">
            <div class="result-banner fade-in" id="dp-banner">
              <div class="label">í”¼ë¶€ì–‘ì ìê²©</div>
              <div class="amount" id="dp-status">-</div>
              <div class="sub" id="dp-sub">-</div>
            </div>

            <div class="card fade-in">
              <h2 class="card-title"><span class="card-icon">ğŸ“‹</span>íŒì • ìƒì„¸</h2>
              <div id="dp-reasons"></div>
            </div>

            <div class="card fade-in hidden" id="dp-alt-card">
              <h2 class="card-title"><span class="card-icon">ğŸ’¡</span>í”¼ë¶€ì–‘ì íƒˆë½ ì‹œ ëŒ€ì•ˆ</h2>
              <div class="result-details">
                <div class="result-row">
                  <span class="label">ì˜ˆìƒ ì§€ì—­ê°€ì…ì ë³´í—˜ë£Œ</span>
                  <span class="value negative" id="dp-alt-regional">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ì—°ê°„ ë¶€ë‹´ì•¡</span>
                  <span class="value negative" id="dp-alt-annual">-</span>
                </div>
              </div>
              <div class="info-box warning mt-sm">
                <span class="icon">âš ï¸</span>
                <div>í”¼ë¶€ì–‘ì ìê²©ì„ ìœ ì§€í•˜ë ¤ë©´ ì†Œë“ì„ ì¤„ì´ê±°ë‚˜ ì¬ì‚°ì„ ì¡°ì •í•˜ëŠ” ê²ƒì´ ìœ ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ <strong>ì—°ê¸ˆ ìˆ˜ë ¹ì•¡ ì¡°ì ˆ</strong>ì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==============================
         íƒ­3: ì„ì˜ê³„ì† vs ì§€ì—­
         ============================== -->
    <div class="tab-content" id="tab-compare">
      <div class="calc-layout">
        <div class="calc-input-panel">
          <div class="card">
            <h2 class="card-title"><span class="card-icon">ğŸ“</span>ë¹„êµ ì¡°ê±´ ì…ë ¥</h2>
            <form id="hiCompareForm">
              <div class="input-section">
                <div class="input-section-title">í‡´ì§ ì „ ì •ë³´</div>
                <div class="form-group">
                  <label class="form-label">í‡´ì§ ì „ ì›”ê¸‰ì—¬ <span class="unit">(ë§Œì›)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="lastSalary" data-type="money" value="400">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
              </div>
              <div class="input-section">
                <div class="input-section-title">í‡´ì§ í›„ ì •ë³´</div>
                <div class="form-group">
                  <label class="form-label">í‡´ì§ í›„ ì—°ê°„ì†Œë“ <span class="unit">(ë§Œì›)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="postIncome" data-type="money" value="1,200">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
                <div class="form-group">
                  <label class="form-label">ì¬ì‚°ì„¸ ê³¼í‘œ <span class="unit">(ë§Œì›)</span></label>
                  <div class="input-group">
                    <input type="text" class="form-input" name="postProperty" data-type="money" value="30,000">
                    <span class="input-suffix">ë§Œì›</span>
                  </div>
                </div>
              </div>
              <button type="button" class="btn btn-primary btn-block btn-lg" onclick="HealthIns.calcCompare()">ë¹„êµí•˜ê¸°</button>
            </form>
          </div>
        </div>

        <div class="calc-result-panel">
          <div id="cm-empty" class="card">
            <div class="empty-result">
              <div class="icon">âš–ï¸</div>
              <div class="text">ì¡°ê±´ì„ ì…ë ¥í•˜ê³  ë¹„êµí•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
            </div>
          </div>

          <div id="cm-result" class="hidden">
            <div class="compare-grid fade-in">
              <div class="compare-card" id="cm-vol-card">
                <span class="badge blue">ì„ì˜ê³„ì†ê°€ì…</span>
                <div class="result-row">
                  <span class="label">ì›” ë³´í—˜ë£Œ</span>
                  <span class="value highlight" id="cm-vol-monthly">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ì¥ê¸°ìš”ì–‘</span>
                  <span class="value" id="cm-vol-ltc">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ì›” í•©ê³„</span>
                  <span class="value highlight" id="cm-vol-total">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ìœ ì§€ ê¸°ê°„</span>
                  <span class="value">ìµœëŒ€ 3ë…„</span>
                </div>
              </div>
              <div class="compare-vs">VS</div>
              <div class="compare-card" id="cm-reg-card">
                <span class="badge orange">ì§€ì—­ê°€ì…ì</span>
                <div class="result-row">
                  <span class="label">ì›” ë³´í—˜ë£Œ</span>
                  <span class="value highlight" id="cm-reg-monthly">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ì¥ê¸°ìš”ì–‘</span>
                  <span class="value" id="cm-reg-ltc">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ì›” í•©ê³„</span>
                  <span class="value highlight" id="cm-reg-total">-</span>
                </div>
                <div class="result-row">
                  <span class="label">ìœ ì§€ ê¸°ê°„</span>
                  <span class="value">ì œí•œ ì—†ìŒ</span>
                </div>
              </div>
            </div>

            <div class="info-box success fade-in">
              <span class="icon">âœ…</span>
              <div id="cm-recommend-text"></div>
            </div>

            <div class="card fade-in">
              <h2 class="card-title"><span class="card-icon">ğŸ“Š</span>3ë…„ê°„ ë³´í—˜ë£Œ ë¹„êµ</h2>
              <div class="chart-container">
                <canvas id="cmChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer id="footer"></footer>

  <script src="../js/constants.js"></script>
  <script src="../js/calculator-engine.js"></script>
  <script src="../js/common.js"></script>
  <script>
    const HealthIns = {
      switchTab(tabId, btn) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('tab-' + tabId).classList.add('active');
        btn.classList.add('active');
        APP.input.initMoneyFields();
      },

      calcRegional() {
        const calcBtn = document.querySelector('#hiRegionalForm .btn-primary');
        APP.button.loading(calcBtn);
        const form = document.getElementById('hiRegionalForm');
        const getVal = (name) => Number(form[name].value.replace(/[^0-9]/g, '')) * 10000;

        const pensionIncome = getVal('pensionIncome');
        const otherIncome = getVal('otherIncome');
        const annualIncome = pensionIncome + otherIncome;
        const propertyValue = Number(form.propertyValue.value.replace(/[^0-9]/g, ''));
        const carValue = Number(form.carValue.value.replace(/[^0-9]/g, ''));
        const carCC = Number(form.carCC.value) || 0;

        const result = CalcEngine.healthInsurance.calcRegionalPremium(annualIncome, propertyValue, carValue, carCC);

        document.getElementById('rg-empty').classList.add('hidden');
        document.getElementById('rg-result').classList.remove('hidden');

        document.getElementById('rg-total').textContent = APP.format.won(result.total) + '/ì›”';
        document.getElementById('rg-health').textContent = APP.format.won(result.monthlyPremium);
        document.getElementById('rg-ltc').textContent = APP.format.won(result.longTermCare);
        document.getElementById('rg-annual').textContent = APP.format.manwon(result.total * 12);

        // êµ¬ì„± ë‚´ì—­
        const basicDeduction = CONSTANTS.HEALTH_INSURANCE.REGIONAL.BASIC_DEDUCTION;
        const afterDeduction = Math.max(propertyValue - basicDeduction, 0);
        document.getElementById('rg-details').innerHTML = `
          <div class="result-row">
            <span class="label">ì†Œë“ ë¶€ë¶„ ë³´í—˜ë£Œ</span>
            <span class="value">${APP.format.won(result.breakdown.income)}</span>
          </div>
          <div class="result-row">
            <span class="label">ì¬ì‚°ê³¼í‘œ</span>
            <span class="value">${APP.format.manwon(propertyValue * 10000)}</span>
          </div>
          <div class="result-row">
            <span class="label">ì¬ì‚° ê¸°ë³¸ê³µì œ</span>
            <span class="value">-${APP.format.manwon(basicDeduction * 10000)}</span>
          </div>
          <div class="result-row">
            <span class="label">ê³µì œ í›„ ì¬ì‚°ê¸ˆì•¡ (ë“±ê¸‰ ì‚°ì • ê¸°ì¤€)</span>
            <span class="value">${APP.format.manwon(afterDeduction * 10000)}</span>
          </div>
          <div class="result-row">
            <span class="label">ì¬ì‚° ë¶€ë¶„ ë³´í—˜ë£Œ</span>
            <span class="value">${APP.format.won(result.breakdown.property)}</span>
          </div>
          <div class="result-row">
            <span class="label">ìë™ì°¨ ë¶€ë¶„ ë³´í—˜ë£Œ (2024.02 íì§€)</span>
            <span class="value">${APP.format.won(0)}</span>
          </div>
          <div class="result-row">
            <span class="label"><strong>ê±´ê°•ë³´í—˜ë£Œ ì†Œê³„</strong></span>
            <span class="value highlight"><strong>${APP.format.won(result.monthlyPremium)}</strong></span>
          </div>
          <div class="result-row">
            <span class="label">ì¥ê¸°ìš”ì–‘ë³´í—˜ë£Œ (ê±´ë³´ë£Œì˜ ${(CONSTANTS.HEALTH_INSURANCE.LONG_TERM_CARE_RATE * 100).toFixed(2)}%)</span>
            <span class="value">${APP.format.won(result.longTermCare)}</span>
          </div>
          <div class="result-row">
            <span class="label"><strong>ì›” ë‚©ë¶€ í•©ê³„</strong></span>
            <span class="value highlight"><strong>${APP.format.won(result.total)}</strong></span>
          </div>
        `;

        // ì°¨íŠ¸
        APP.chart.create('rgChart', {
          type: 'doughnut',
          data: {
            labels: ['ì†Œë“ ë¶€ë¶„', 'ì¬ì‚° ë¶€ë¶„', 'ìë™ì°¨ ë¶€ë¶„', 'ì¥ê¸°ìš”ì–‘'],
            datasets: [{
              data: [result.breakdown.income, result.breakdown.property, result.breakdown.car, result.longTermCare],
              backgroundColor: [APP.chart.colors.primary, APP.chart.colors.accent, APP.chart.colors.info, APP.chart.colors.secondary],
              borderWidth: 2,
            }]
          },
          options: {
            plugins: {
              title: { display: true, text: `ì›” ${APP.format.won(result.total)} êµ¬ì„±`, font: { size: 16 } }
            }
          }
        });

        APP.storage.saveForm('hiRegionalForm');
        requestAnimationFrame(() => APP.button.reset(calcBtn));
      },

      calcDependent() {
        const calcBtn = document.querySelector('#hiDependentForm .btn-primary');
        APP.button.loading(calcBtn);
        const form = document.getElementById('hiDependentForm');
        const annualIncome = Number(form.annualIncome.value.replace(/[^0-9]/g, '')) * 10000;
        const propertyTax = Number(form.propertyTax.value.replace(/[^0-9]/g, '')) * 10000;

        const result = CalcEngine.healthInsurance.checkDependentStatus(annualIncome, propertyTax);

        document.getElementById('dp-empty').classList.add('hidden');
        document.getElementById('dp-result').classList.remove('hidden');

        const banner = document.getElementById('dp-banner');
        banner.classList.remove('success', 'danger');
        if (result.qualified) {
          banner.classList.add('success');
          document.getElementById('dp-status').textContent = 'ìê²© ì¶©ì¡± âœ“';
          document.getElementById('dp-sub').textContent = 'í”¼ë¶€ì–‘ìë¡œ ë“±ë¡ ê°€ëŠ¥í•˜ë©° ë³´í—˜ë£Œê°€ ë©´ì œë©ë‹ˆë‹¤';
          document.getElementById('dp-alt-card').classList.add('hidden');
        } else {
          banner.classList.add('danger');
          document.getElementById('dp-status').textContent = 'ìê²© ë¯¸ì¶©ì¡± âœ—';
          document.getElementById('dp-sub').textContent = 'í”¼ë¶€ì–‘ì ìê²© ìš”ê±´ì„ ì¶©ì¡±í•˜ì§€ ëª»í•©ë‹ˆë‹¤';

          // ì§€ì—­ê°€ì…ì ì˜ˆìƒ ë³´í—˜ë£Œ
          const regional = CalcEngine.healthInsurance.calcRegionalPremium(annualIncome, propertyTax / 10000, 0, 0);
          document.getElementById('dp-alt-card').classList.remove('hidden');
          document.getElementById('dp-alt-regional').textContent = APP.format.won(regional.total) + '/ì›”';
          document.getElementById('dp-alt-annual').textContent = APP.format.manwon(regional.total * 12);
        }

        // íŒì • ì‚¬ìœ 
        document.getElementById('dp-reasons').innerHTML = result.reasons.map(r =>
          `<div class="info-box ${result.qualified ? 'success' : 'danger'} mb-md">
            <span class="icon">${result.qualified ? 'âœ…' : 'âŒ'}</span>
            <div>${r}</div>
          </div>`
        ).join('');

        APP.storage.saveForm('hiDependentForm');
        requestAnimationFrame(() => APP.button.reset(calcBtn));
      },

      calcCompare() {
        const calcBtn = document.querySelector('#hiCompareForm .btn-primary');
        APP.button.loading(calcBtn);
        const form = document.getElementById('hiCompareForm');
        const lastSalary = Number(form.lastSalary.value.replace(/[^0-9]/g, '')) * 10000;
        const postIncome = Number(form.postIncome.value.replace(/[^0-9]/g, '')) * 10000;
        const postProperty = Number(form.postProperty.value.replace(/[^0-9]/g, ''));

        const result = CalcEngine.healthInsurance.compareVoluntaryVsRegional(lastSalary, postIncome, postProperty);

        document.getElementById('cm-empty').classList.add('hidden');
        document.getElementById('cm-result').classList.remove('hidden');

        document.getElementById('cm-vol-monthly').textContent = APP.format.won(result.voluntary.premium);
        document.getElementById('cm-vol-ltc').textContent = APP.format.won(result.voluntary.longTermCare);
        document.getElementById('cm-vol-total').textContent = APP.format.won(result.voluntary.total);
        document.getElementById('cm-reg-monthly').textContent = APP.format.won(result.regional.premium);
        document.getElementById('cm-reg-ltc').textContent = APP.format.won(result.regional.longTermCare);
        document.getElementById('cm-reg-total').textContent = APP.format.won(result.regional.total);

        const volCard = document.getElementById('cm-vol-card');
        const regCard = document.getElementById('cm-reg-card');
        if (result.recommended === 'ì„ì˜ê³„ì†ê°€ì…') {
          volCard.classList.add('recommended');
          regCard.classList.remove('recommended');
        } else {
          regCard.classList.add('recommended');
          volCard.classList.remove('recommended');
        }

        const saving = Math.abs(result.monthlySaving);
        document.getElementById('cm-recommend-text').innerHTML =
          `<strong>${result.recommended}ì´ ìœ ë¦¬í•©ë‹ˆë‹¤.</strong> ì›” <strong>${APP.format.won(saving)}</strong> ì ˆì•½<br>` +
          (result.recommended === 'ì„ì˜ê³„ì†ê°€ì…'
            ? `ì„ì˜ê³„ì†ê°€ì…ì€ ìµœëŒ€ <strong>3ë…„</strong>ê¹Œì§€ ìœ ì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤. 3ë…„ê°„ ì´ <strong>${APP.format.manwon(saving * 36)}</strong> ì ˆì•½ë©ë‹ˆë‹¤.`
            : `ì§€ì—­ê°€ì…ìë¡œ ë°”ë¡œ ì „í™˜í•˜ëŠ” ê²ƒì´ ë” ì €ë ´í•©ë‹ˆë‹¤.`);

        // 3ë…„ ë¹„êµ ì°¨íŠ¸
        const labels = [];
        const volData = [];
        const regData = [];
        for (let m = 1; m <= 36; m++) {
          if (m % 3 === 0 || m === 1) {
            labels.push(m + 'ê°œì›”');
            volData.push(result.voluntary.total * m);
            regData.push(result.regional.total * m);
          }
        }

        APP.chart.create('cmChart', {
          type: 'line',
          data: {
            labels,
            datasets: [
              {
                label: 'ì„ì˜ê³„ì†ê°€ì… ëˆ„ì ',
                data: volData.map(v => Math.round(v / 10000)),
                borderColor: APP.chart.colors.primary,
                tension: 0.3,
              },
              {
                label: 'ì§€ì—­ê°€ì…ì ëˆ„ì ',
                data: regData.map(v => Math.round(v / 10000)),
                borderColor: APP.chart.colors.danger,
                borderDash: [5, 5],
                tension: 0.3,
              }
            ]
          },
          options: {
            plugins: {
              title: { display: true, text: '3ë…„ê°„ ëˆ„ì  ë³´í—˜ë£Œ ë¹„êµ (ë§Œì›)', font: { size: 16 } }
            },
            scales: { y: { title: { display: true, text: 'ë§Œì›' }, beginAtZero: true } }
          }
        });

        APP.storage.saveForm('hiCompareForm');
        requestAnimationFrame(() => APP.button.reset(calcBtn));
      },
    };

    document.addEventListener('DOMContentLoaded', () => {
      APP.storage.restoreForm('hiRegionalForm');
      APP.storage.restoreForm('hiDependentForm');
      APP.storage.restoreForm('hiCompareForm');
    });
  </script>
</body>
</html>
